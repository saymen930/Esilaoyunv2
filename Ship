import telebot

# Telegram bot token'ını buraya ekleyin
TOKEN = '6761753644:AAGfrsu3AEL4NN26UW1SIDACwWAsrgV93vE'

# Telegram bot nesnesini oluşturun
bot = telebot.TeleBot(TOKEN)

# Kullanıcılar ve ilişkilerin saklandığı bir sözlük
relationships = {}

# "ship" komutunu işle
@bot.message_handler(commands=['ship'])
def handle_ship_command(message):
    # Gönderenin ID'sini al
    user_id = message.from_user.id
    
    # Eğer kullanıcı zaten bir ilişkideyse
    if user_id in relationships:
        bot.reply_to(message, "Zaten bir ilişkiniz var.")
    else:
        # Diğer kullanıcının ID'sini al
        other_user_id = get_other_user_id(message)
        
        # Eğer diğer kullanıcı yoksa
        if other_user_id is None:
            bot.reply_to(message, "Kiminle bir ilişki kurmak istediğini belirtmelisin.")
        else:
            # İlişkiyi kaydet
            relationships[user_id] = other_user_id
            relationships[other_user_id] = user_id
            bot.reply_to(message, "İlişki başarıyla oluşturuldu!")

# Verilen mesajdan diğer kullanıcının ID'sini al
def get_other_user_id(message):
    # Mesajdaki metni al
    text = message.text
    
    # Komutun argümanlarını al
    args = text.split()[1:]
    
    # Eğer argümanlar boşsa veya sadece komut varsa
    if not args:
        return None
    
    # İlk argümanı al (diğer kullanıcının username'i veya ID'si)
    other_user_arg = args[0]
    
    # Eğer argüman bir username ise
    if other_user_arg.startswith('@'):
        # Username'den kullanıcıyı bul
        user = bot.get_chat(other_user_arg)
        return user.id if user else None
    # Eğer argüman bir ID ise
    elif other_user_arg.isdigit():
        return int(other_user_arg)
    else:
        return None

# Ana döngü
bot.polling()
